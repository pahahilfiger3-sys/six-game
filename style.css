:root { 
    --neon-blue: #00f3ff; 
    --neon-pink: #ff00ff; 
    --neon-green: #00ff88; /* STRICT GREEN */
    --neon-purple: #b800ff;
    --bg-dark: #000000; 
    --gold: #ffd700; 
    --gold-dark: #b8860b;
    --glass-bg: rgba(255, 255, 255, 0.05);
    --glass-border: rgba(255, 255, 255, 0.1);
    
    /* Gift Colors */
    --color-heart: #ff0055;
    --color-spy: #ffd700;
    --color-xray: #00f3ff;
}

* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

/* --- GLOBAL LAYOUT & TYPOGRAPHY --- */
body { 
    font-family: 'Rajdhani', sans-serif;
    background: var(--bg-dark);
    color: #fff;
    height: 100vh;
    overflow: hidden;
    display: flex; justify-content: center;
}

#app-container {
    width: 100%;
    max-width: 500px; 
    height: 100%;
    background: radial-gradient(circle at center, #1a1a1a 0%, #0a0a0a 50%, #000 100%);
    display: flex; flex-direction: column;
    position: relative;
    overflow: hidden;
}

.screen { 
    display: none; 
    flex: 1; 
    flex-direction: column; 
    width: 100%; 
    height: 100%;
    position: relative; 
}
.screen.active { display: flex; }

/* --- SCROLL FIXES --- */
.scroll-content {
    flex: 1;
    width: 100%;
    overflow-y: auto;
    padding-bottom: 120px; 
    -webkit-overflow-scrolling: touch;
}

/* --- LOBBY STYLES --- */
.header { padding: 60px 20px 20px; text-align: center; z-index: 10; }
.game-title {
    font-family: 'Orbitron', sans-serif; font-size: 32px; font-weight: 900; letter-spacing: 4px;
    background: linear-gradient(135deg, #ffd700 0%, #ffed4e 50%, #ffd700 100%);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    filter: drop-shadow(0 2px 10px rgba(255, 215, 0, 0.4)); margin-bottom: 8px;
}
.game-subtitle { font-size: 12px; color: rgba(255, 255, 255, 0.5); letter-spacing: 2px; text-transform: uppercase; }
.online-badge {
    display: inline-flex; align-items: center; gap: 8px; padding: 8px 20px;
    background: rgba(255, 215, 0, 0.1); border: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 20px; margin-top: 20px; backdrop-filter: blur(10px);
    font-size: 13px; font-weight: 600; color: #ffd700;
}
.online-dot {
    width: 8px; height: 8px; background: #ffd700; border-radius: 50%;
    box-shadow: 0 0 10px #ffd700; animation: pulse-gold 2s infinite;
}
@keyframes pulse-gold { 0%, 100% { opacity: 1; } 50% { opacity: 0.6; } }

.main-content { flex: 1; display: flex; align-items: center; justify-content: center; z-index: 10; width: 100%; padding-bottom: 80px; }

/* Start Button (Gold Coin) */
.start-button {
    position: relative; width: 240px; height: 240px; cursor: pointer;
    border: none; background: none; transition: transform 0.1s;
}
.start-button:active { transform: scale(0.96); }
.coin {
    position: relative; width: 100%; height: 100%; border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #ffed4e 0%, #ffd700 30%, #daa520 60%, #8b6914 100%);
    box-shadow: 0 15px 40px rgba(255, 215, 0, 0.3), 0 20px 60px rgba(0, 0, 0, 0.6), inset -5px -5px 15px rgba(0, 0, 0, 0.4), inset 5px 5px 15px rgba(255, 237, 78, 0.6);
    display: flex; align-items: center; justify-content: center;
}
.coin::before {
    content: ''; position: absolute; inset: 12px; border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #ffed4e 0%, #ffd700 50%, #daa520 100%);
    box-shadow: inset 0 2px 5px rgba(255, 237, 78, 0.8), inset 0 -2px 5px rgba(0, 0, 0, 0.3);
}
.button-text {
    position: relative; z-index: 10; font-family: 'Orbitron', sans-serif;
    font-size: 42px; font-weight: 900; letter-spacing: 4px; color: #1a1a1a;
    text-shadow: 0 1px 2px rgba(255, 255, 255, 0.5);
}
.balance {
    font-family: 'Orbitron', sans-serif; padding: 20px; text-align: center;
    font-size: 14px; color: rgba(255, 255, 255, 0.6); z-index: 10; margin-bottom: 130px;
}
.balance-amount { color: #ffd700; font-weight: 700; font-size: 18px; }

/* --- NAVIGATION --- */
.bottom-nav {
    position: absolute; bottom: 30px; width: 90%; height: 70px; left: 5%;
    background: transparent; border: 2px solid rgba(255, 200, 100, 0.2);
    border-radius: 35px; display: flex; justify-content: space-around; align-items: center; z-index: 100;
}
.nav-item {
    width: 60px; height: 50px; display: flex; align-items: center; justify-content: center;
    border-radius: 25px; position: relative; overflow: hidden; cursor: pointer; transition: all 0.3s ease;
}
.nav-item.active::before {
    content: ''; position: absolute; inset: 0;
    background: linear-gradient(135deg, #ffd700 0%, #b8860b 100%);
    border-radius: 25px; animation: liquidFill 0.6s ease-out forwards; z-index: 0;
}
@keyframes liquidFill { 0% { transform: translateY(100%); } 100% { transform: translateY(0); } }
.nav-icon {
    width: 28px; height: 28px; fill: rgba(255, 255, 255, 0.4);
    position: relative; z-index: 1; transition: fill 0.3s ease;
}
.nav-item.active .nav-icon { fill: #1a1510; }

/* --- SEARCH & PROCESSING --- */
.processing-container {
    flex-grow: 1; display: flex; flex-direction: column;
    justify-content: center; align-items: center; z-index: 5000;
}
.spinner {
    width: 80px; height: 80px; border: 4px solid var(--neon-blue);
    border-radius: 50%; border-top-color: transparent !important;
    animation: spin 1s linear infinite; margin-bottom: 20px;
}
@keyframes spin { 100% { transform: rotate(360deg); } }
.neon-loader {
    width: 100px; height: 100px; border: 5px solid transparent;
    border-top-color: var(--neon-blue); border-bottom-color: var(--neon-pink);
    border-radius: 50%; animation: neon-spin 1.5s linear infinite;
    box-shadow: 0 0 20px var(--neon-blue), 0 0 20px var(--neon-pink); margin-bottom: 30px;
}
@keyframes neon-spin {
    0% { transform: rotate(0deg) scale(1); } 50% { transform: rotate(180deg) scale(1.1); } 100% { transform: rotate(360deg) scale(1); }
}
.processing-text {
    font-family: 'Orbitron', sans-serif; font-size: 18px; font-weight: 800;
    color: var(--neon-blue); letter-spacing: 2px; text-transform: uppercase;
    animation: blink 1s infinite alternate;
}
.processing-subtext { font-size: 13px; color: #666; margin-top: 10px; letter-spacing: 1px; }
@keyframes blink { from { opacity: 1; } to { opacity: 0.5; } }

/* --- GAME SCREEN HEADER --- */
.game-header {
    height: 180px;
    display: flex; flex-direction: column; 
    z-index: 10; padding: 20px 20px 0;
    background: linear-gradient(180deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 100%);
}

.top-row {
    display: flex; justify-content: space-between; align-items: center;
    margin-bottom: 15px;
}

.timer {
    font-family: 'Orbitron', sans-serif; font-size: 24px; font-weight: 700;
    color: #ffd700; text-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
}

.round-info {
    font-size: 12px; color: rgba(255, 255, 255, 0.4); letter-spacing: 2px;
    text-transform: uppercase;
}

.mini-exit {
    font-size: 18px; color: #666; cursor: pointer; padding: 5px;
}

.header-display-area {
    flex: 1;
    display: flex; align-items: center; justify-content: center;
    background: rgba(255, 255, 255, 0.05);
    border-radius: 15px; border: 1px solid rgba(255, 215, 0, 0.1);
    backdrop-filter: blur(5px);
    padding: 15px;
    position: relative;
    overflow: hidden;
}

/* Question View */
#question-view {
    width: 100%; text-align: center;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
}
.question-text-header {
    font-size: 16px; color: rgba(255, 255, 255, 0.9); font-weight: 600;
    line-height: 1.4;
}

/* --- NEW STATUS TEXT (GREEN INSTRUCTIONS) --- */
.status-dynamic {
    font-family: 'Orbitron', sans-serif;
    font-size: 12px;
    font-weight: 800;
    color: var(--neon-green);
    letter-spacing: 2px;
    text-transform: uppercase;
    margin-top: 12px;
    text-shadow: 0 0 10px rgba(0, 255, 136, 0.4);
    animation: pulse-green 2s infinite;
}
@keyframes pulse-green { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

/* Spotlight View */
#spotlight-view {
    width: 100%; height: 100%;
    display: flex; flex-direction: column; align-items: center; justify-content: center;
}
.hidden { display: none !important; }

.spotlight-name {
    font-family: 'Orbitron', sans-serif; font-size: 14px; color: var(--neon-blue);
    letter-spacing: 2px; margin-bottom: 10px; text-transform: uppercase;
    text-shadow: 0 0 10px var(--neon-blue);
}

#spotlight-content {
    width: 100%; display: flex; align-items: center; justify-content: center;
}

/* Waveform Animation */
.waveform-container {
    display: flex; align-items: center; justify-content: center; gap: 4px;
    height: 40px; width: 100%;
}
.wave-bar {
    width: 6px; background: linear-gradient(180deg, var(--gold) 0%, rgba(255, 215, 0, 0.4) 100%);
    border-radius: 3px; transform: scaleY(0.4); opacity: 0.5;
    box-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
}
.waveform-container.active .wave-bar { animation: waveJump 0.8s ease-in-out infinite alternate; }
.waveform-container.active .wave-bar:nth-child(1) { animation-delay: 0s; height: 15px; }
.waveform-container.active .wave-bar:nth-child(2) { animation-delay: 0.1s; height: 25px; }
.waveform-container.active .wave-bar:nth-child(3) { animation-delay: 0.2s; height: 35px; }
.waveform-container.active .wave-bar:nth-child(4) { animation-delay: 0.3s; height: 40px; }
.waveform-container.active .wave-bar:nth-child(5) { animation-delay: 0.4s; height: 35px; }
.waveform-container.active .wave-bar:nth-child(6) { animation-delay: 0.5s; height: 25px; }
.waveform-container.active .wave-bar:nth-child(7) { animation-delay: 0.6s; height: 15px; }
@keyframes waveJump { 0% { transform: scaleY(0.4); opacity: 0.5; } 100% { transform: scaleY(1.2); opacity: 1; } }

/* Typewriter Text */
.typewriter-text {
    font-size: 15px; font-weight: 600; color: #fff; text-align: center;
    white-space: pre-wrap; border-right: 2px solid var(--gold);
    padding-right: 5px; animation: blinkCursor 0.75s step-end infinite;
}
@keyframes blinkCursor { 50% { border-color: transparent; } }

/* Game Grid */
.arena-grid {
    flex: 1; display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
    padding: 0 20px 100px; align-content: center; position: relative;
}
#connections-layer {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    pointer-events: none; z-index: 0;
}
.line-normal { stroke: var(--neon-blue); stroke-width: 2; opacity: 0.6; stroke-linecap: round; }
.line-match {
    stroke: #ffd700; stroke-width: 2px; opacity: 1; stroke-linecap: round;
    filter: drop-shadow(0 0 5px var(--gold)); stroke-dasharray: 10;
    animation: dash 1s linear infinite;
}
@keyframes dash { to { stroke-dashoffset: -20; } }

/* Player Card */
.player-card {
    display: flex; flex-direction: column; align-items: center; justify-content: center;
    position: relative; transition: all 0.3s ease; z-index: 1;
}
.avatar-wrapper {
    width: 70px; height: 70px; border-radius: 20px; position: relative;
    background: rgba(255, 255, 255, 0.05); border: 1px solid rgba(255, 255, 255, 0.1);
    transition: all 0.3s ease; display: flex; align-items: center; justify-content: center;
    /* UPDATED FOR ANIMATIONS */
    overflow: visible !important; 
}
.avatar {
    width: 100%; height: 100%; border-radius: 20px; background-size: cover; background-position: center;
    opacity: 0.7; transition: all 0.3s ease;
    /* UPDATED FOR ANIMATIONS */
    z-index: 2; position: relative;
}
.name-tag {
    margin-top: 8px; font-size: 13px; font-weight: 600; color: rgba(255, 255, 255, 0.5);
    font-family: 'Orbitron', sans-serif;
}
.player-card.playing .avatar-wrapper {
    border-color: #ffd700; box-shadow: 0 0 25px rgba(255, 215, 0, 0.4); transform: scale(1.05);
}
.player-card.playing .avatar { opacity: 1; }
.player-card.playing .name-tag { color: #ffd700; text-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }
.avatar.blur-mask { filter: blur(6px) grayscale(0.5); }
.avatar.reveal { filter: none !important; opacity: 1 !important; }
.status-check {
    position: absolute; top: -5px; right: -5px; width: 20px; height: 20px;
    background: #000; border: 2px solid var(--neon-green); border-radius: 50%;
    box-shadow: 0 0 10px var(--neon-green); display: flex; align-items: center; justify-content: center; z-index: 50;
}
.status-check svg { width: 12px; height: 12px; fill: none; stroke: var(--neon-green); stroke-width: 3; }

/* Game Controls Bar */
.game-controls {
    position: absolute; bottom: 30px; left: 50%; transform: translateX(-50%);
    width: 90%; height: 80px; background: rgba(0, 0, 0, 0.6); backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 215, 0, 0.2); border-radius: 40px;
    display: flex; justify-content: space-evenly; align-items: center; padding: 0 10px;
    z-index: 100; box-shadow: 0 10px 40px rgba(0,0,0,0.5);
}
.action-btn {
    width: 44px; height: 44px; border-radius: 50%; background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1); display: flex; align-items: center; justify-content: center;
    cursor: pointer; transition: all 0.2s;
}
.action-btn:active { transform: scale(0.9); background: rgba(255,255,255,0.1); }
.action-btn svg { width: 20px; height: 20px; fill: rgba(255,255,255,0.7); }
.action-btn.disabled { opacity: 0.3; pointer-events: none; }

.mic-btn {
    width: 64px; height: 64px; border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #444 0%, #222 100%);
    border: 2px solid rgba(255, 255, 255, 0.2); box-shadow: 0 5px 15px rgba(0,0,0,0.5);
}
.mic-btn.recording {
    background: radial-gradient(circle at 30% 30%, #ff0055 0%, #b80055 100%);
    border-color: #ff0055; box-shadow: 0 0 20px rgba(255, 0, 85, 0.6);
}
.mic-btn svg { width: 28px; height: 28px; fill: #fff; }

/* Gift Button */
.gift-menu-btn svg { stroke: #ffd700; fill: none; }

/* --- VERTICAL GIFT MODAL --- */
#gift-modal {
    position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(15px);
    z-index: 3000; display: none; align-items: center; justify-content: center;
}
#gift-modal.active { display: flex; }
.gift-modal-content {
    width: 85%; max-width: 320px; background: rgba(20, 20, 25, 0.9);
    border: 1px solid var(--gold); border-radius: 20px; padding: 25px;
    display: flex; flex-direction: column; align-items: center;
    box-shadow: 0 0 30px rgba(255, 215, 0, 0.2);
}

.vertical-modal { width: 100%; display: flex; flex-direction: column; gap: 15px; }
.modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
.modal-title { font-family: 'Orbitron', sans-serif; font-size: 18px; font-weight: 800; color: var(--gold); letter-spacing: 1px; }
.modal-close { font-size: 20px; color: #666; cursor: pointer; padding: 5px; }

.vertical-list { display: flex; flex-direction: column; gap: 12px; }
.v-item { 
    display: flex; align-items: center; padding: 12px; 
    background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.1); 
    border-radius: 16px; transition: 0.2s; cursor: pointer;
}
.v-item:active { background: rgba(255,255,255,0.1); transform: scale(0.98); }

.v-icon-box { 
    width: 40px; height: 40px; border-radius: 12px; border: 1px solid currentColor; 
    display: flex; align-items: center; justify-content: center; margin-right: 15px; 
    background: rgba(0,0,0,0.3); 
}
.v-icon-box svg { width: 24px; height: 24px; }

.v-info { flex: 1; display: flex; flex-direction: column; }
.v-name { font-family: 'Orbitron', sans-serif; font-weight: 700; font-size: 14px; margin-bottom: 2px; }
.v-desc { font-size: 11px; color: rgba(255,255,255,0.5); }
.v-price { font-family: 'Orbitron', sans-serif; font-size: 14px; color: #fff; font-weight: 700; }

/* --- CHAT LIST --- */
.screen-title {
    font-family: 'Orbitron', sans-serif; font-size: 28px; font-weight: 900;
    letter-spacing: 4px; color: #fff; text-shadow: 0 0 20px rgba(255, 215, 0, 0.3); margin-bottom: 20px;
}
.tab-container { display: flex; justify-content: center; margin-bottom: 30px; }
.tab-box {
    background: rgba(255, 255, 255, 0.05); border-radius: 30px; padding: 4px;
    display: flex; border: 1px solid rgba(255, 215, 0, 0.2); width: 90%;
}
.tab {
    flex: 1; text-align: center; padding: 10px; border-radius: 25px;
    font-family: 'Orbitron', sans-serif; font-size: 12px; font-weight: 700;
    color: rgba(255, 255, 255, 0.5); cursor: pointer; transition: all 0.3s ease;
}
.tab.active {
    background: linear-gradient(90deg, #ffd700 0%, #ffaa00 100%);
    color: #000; box-shadow: 0 0 15px rgba(255, 215, 0, 0.4);
}
.chat-list { 
    padding: 0 20px; display: flex; flex-direction: column; gap: 25px; 
    overflow-y: auto; padding-bottom: 120px; flex: 1; 
}
.chat-item {
    position: relative; margin-left: 30px; background: rgba(20, 20, 25, 0.6);
    backdrop-filter: blur(15px); border: 1px solid rgba(255, 215, 0, 0.15);
    border-radius: 20px; padding: 20px 20px 20px 50px; height: 90px;
    display: flex; align-items: center; justify-content: space-between; cursor: pointer;
}
.chat-avatar {
    position: absolute; left: -25px; top: 50%; transform: translateY(-50%);
    width: 65px; height: 65px; border-radius: 18px; background-size: cover; background-position: center;
    border: 2px solid rgba(255, 215, 0, 0.5); box-shadow: 0 5px 15px rgba(0,0,0,0.5); background-color: #000;
}
.chat-info { display: flex; flex-direction: column; width: 100%; }
.chat-name { font-family: 'Orbitron', sans-serif; font-size: 16px; font-weight: 700; color: #fff; }
.chat-preview { font-size: 13px; color: rgba(255, 255, 255, 0.5); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; max-width: 160px; }
.chat-restore-btn {
    background: var(--gold); border: none; border-radius: 15px; padding: 5px 10px;
    font-size: 10px; font-weight: 700; cursor: pointer;
}

/* --- CHAT ROOM --- */
.chat-header-room {
    padding: 40px 20px 15px; display: flex; align-items: center; gap: 15px;
    border-bottom: 1px solid rgba(255, 215, 0, 0.1); background: rgba(0, 0, 0, 0.3); backdrop-filter: blur(10px);
}
.back-btn {
    width: 45px; height: 45px; border-radius: 50%; background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 215, 0, 0.2); display: flex; align-items: center; justify-content: center; cursor: pointer;
}
.back-icon { width: 20px; height: 20px; fill: #ffd700; }
.header-avatar {
    width: 50px; height: 50px; border-radius: 50%; background-size: cover; background-position: center;
    border: 2px solid rgba(255, 215, 0, 0.5); background-color: #000;
}
.header-info { flex: 1; display: flex; flex-direction: column; gap: 2px; }
.header-name { font-family: 'Orbitron', sans-serif; font-size: 18px; font-weight: 700; color: #fff; }
.header-status { font-size: 12px; color: #00ff88; display: flex; align-items: center; gap: 5px; }
.status-dot { width: 8px; height: 8px; background: #00ff88; border-radius: 50%; box-shadow: 0 0 10px #00ff88; }
.chat-area { flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; }
.msg-bubble { max-width: 70%; padding: 12px 16px; border-radius: 18px; position: relative; backdrop-filter: blur(5px); font-size: 15px; }
.msg-left { background: rgba(255, 255, 255, 0.03); border: 1px solid rgba(255, 255, 255, 0.08); color: #fff; align-self: flex-start; }
.msg-right {
    background: linear-gradient(135deg, rgba(255, 215, 0, 0.15) 0%, rgba(255, 170, 0, 0.15) 100%);
    border: 1px solid rgba(255, 215, 0, 0.25); color: #ffd700; align-self: flex-end;
}
.msg-system { align-self: center; font-size: 12px; color: #888; border: 1px solid #333; padding: 5px 10px; border-radius: 10px; }
.msg-invite {
    width: 85%; max-width: 280px; background: rgba(10, 10, 16, 0.95); border: 1px solid var(--gold);
    border-radius: 16px; padding: 20px 15px; align-self: center; display: flex; flex-direction: column; align-items: center; text-align: center;
}
.invite-title { color: var(--gold); font-weight: 800; font-size: 17px; margin-bottom: 8px; font-family: 'Orbitron', sans-serif; }
.invite-btn {
    width: 100%; background: var(--gold); color: black; border: none; padding: 12px 0;
    border-radius: 25px; font-weight: 800; font-size: 16px; cursor: pointer; margin-top: 10px;
}
.input-area { padding: 15px 20px 30px; background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(15px); border-top: 1px solid rgba(255, 215, 0, 0.15); }
.input-container {
    display: flex; align-items: center; gap: 12px; background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 215, 0, 0.2); border-radius: 30px; padding: 8px 8px 8px 15px;
}
.message-input { flex: 1; background: transparent; border: none; outline: none; color: #fff; font-family: 'Rajdhani', sans-serif; font-size: 15px; }
.input-icon-btn { width: 35px; height: 35px; border-radius: 50%; background: transparent; border: none; display: flex; align-items: center; justify-content: center; cursor: pointer; }
.input-icon { width: 22px; height: 22px; fill: rgba(255, 215, 0, 0.7); }
.mic-btn-small {
    width: 45px; height: 45px; border-radius: 50%; background: linear-gradient(135deg, #ffd700 0%, #ffaa00 100%);
    border: none; display: flex; align-items: center; justify-content: center; cursor: pointer;
}
.mic-btn-small .mic-icon { fill: #000; }

/* --- PROFILE --- */
.page-title {
    font-family: 'Orbitron', sans-serif; font-size: 28px; font-weight: 900; letter-spacing: 4px;
    background: linear-gradient(135deg, #ffd700 0%, #ffed4e 50%, #ffd700 100%);
    -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}
.settings-btn {
    width: 40px; height: 40px; background: rgba(74, 74, 74, 0.15); border: 1px solid rgba(74, 74, 74, 0.4);
    border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer;
}
.settings-icon { width: 22px; height: 22px; fill: #6a6a6a; }
.stats-row { display: flex; gap: 12px; padding: 0 20px 20px; z-index: 10; }
.stat-box {
    flex: 1; padding: 16px; background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; text-align: center;
}
.stat-label { font-size: 11px; text-transform: uppercase; letter-spacing: 1px; color: rgba(255, 255, 255, 0.5); margin-bottom: 6px; }
.stat-value { font-family: 'Orbitron', sans-serif; font-size: 22px; font-weight: 700; }
.stat-value.gold { color: #ffd700; text-shadow: 0 0 10px rgba(255, 215, 0, 0.5); }
.stat-value.purple { color: #5a5a5a; text-shadow: 0 0 10px rgba(90, 90, 90, 0.5); }
.profile-card {
    margin: 0 20px 100px; padding: 40px 24px 32px; background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(20px); border: 1px solid rgba(74, 74, 74, 0.25); border-radius: 24px;
}
.avatar-wrapper-profile { display: flex; justify-content: center; margin-bottom: 32px; }
.avatar-large {
    width: 140px; height: 140px; border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, #6a6a6a 0%, #4a4a4a 30%, #2a2a2a 60%, #1a1a1a 100%);
    background-size: cover; background-position: center;
    border: 3px solid #0a0a0a; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.6);
}
.form-group { margin-bottom: 20px; }
.form-label { display: block; font-size: 11px; text-transform: uppercase; letter-spacing: 1px; color: rgba(255, 255, 255, 0.5); margin-bottom: 8px; }
.form-input {
    width: 100%; padding: 14px 16px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px; color: #fff; font-family: 'Rajdhani', sans-serif; font-size: 16px; outline: none;
}
.form-input:focus { border-color: #5a5a5a; }
.gender-toggle { display: flex; gap: 12px; padding: 4px; background: rgba(0, 0, 0, 0.3); border-radius: 12px; border: 1px solid rgba(255, 255, 255, 0.1); }
.gender-option {
    flex: 1; padding: 12px; background: transparent; border: none; border-radius: 8px;
    color: rgba(255, 255, 255, 0.5); font-family: 'Rajdhani', sans-serif; font-size: 15px; font-weight: 600; cursor: pointer;
}
.gender-option.active { background: linear-gradient(135deg, #5a5a5a 0%, #2a2a2a 100%); color: #e0e0e0; }
.save-btn {
    width: 100%; padding: 16px; margin-top: 28px; background: linear-gradient(135deg, #5a5a5a 0%, #2a2a2a 100%);
    border: none; border-radius: 12px; font-family: 'Orbitron', sans-serif; font-size: 16px; font-weight: 700;
    color: #e0e0e0; cursor: pointer;
}

/* --- SHOP --- */
.black-card {
    width: 100%; height: 240px; background: linear-gradient(135deg, #1a1a1a 0%, #0a0a0a 50%, #1a1a1a 100%);
    border-radius: 20px; border: 2px solid #ffd700; box-shadow: 0 30px 60px rgba(0, 0, 0, 0.8);
    padding: 28px; display: flex; flex-direction: column; justify-content: space-between; position: relative; overflow: hidden;
}
.card-corner { position: absolute; top: 0; right: 0; width: 80px; height: 80px; background: linear-gradient(135deg, #ffd700 0%, transparent 60%); opacity: 0.2; }
.card-logo { font-family: 'Orbitron', sans-serif; font-size: 32px; font-weight: 900; background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.card-label { font-size: 10px; letter-spacing: 1.5px; color: rgba(255, 215, 0, 0.6); text-transform: uppercase; }
.card-holder { font-family: 'Orbitron', sans-serif; font-size: 20px; font-weight: 700; color: #ffd700; letter-spacing: 2px; }
.card-chip {
    position: absolute; bottom: 24px; right: 24px; width: 60px; height: 45px;
    background: linear-gradient(135deg, #ffd700 0%, #b8860b 100%); border-radius: 8px;
    display: flex; align-items: center; justify-content: center; cursor: pointer; border: none;
}
.chip-icon { width: 24px; height: 24px; fill: #1a1510; }
.reward-section {
    width: 100%; max-width: 380px; padding: 24px; background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(10px); border: 1px solid rgba(255, 215, 0, 0.2); border-radius: 20px; text-align: center;
}
.reward-value {
    font-family: 'Orbitron', sans-serif; font-size: 42px; font-weight: 900;
    background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
}

/* --- RULES --- */
.rules-list { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 15px; }
.rule-item {
    background: rgba(0, 243, 255, 0.05); border-left: 4px solid var(--neon-blue);
    padding: 15px; border-radius: 0 10px 10px 0; font-size: 16px; line-height: 1.4;
}
.rule-title { font-weight: 800; color: var(--neon-blue); margin-bottom: 5px; display: block; font-family: 'Orbitron', sans-serif; }

/* --- GAME BOTTOM SHEET (UPDATED GLASS DESIGN) --- */
#game-bottom-sheet {
    position: absolute; bottom: 0; left: 0; width: 100%; height: 350px;
    transform: translateY(100%);
    transition: transform 0.3s cubic-bezier(0.2, 0.8, 0.2, 1); z-index: 200;
    display: flex; flex-direction: column;
}
#game-bottom-sheet.active { transform: translateY(0); }

/* New Glass Sheet Styles */
.glass-sheet {
    background: rgba(10, 10, 10, 0.85);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-top: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 30px 30px 0 0;
    box-shadow: 0 -10px 40px rgba(0,0,0,0.5);
}

.glass-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 20px 30px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
}

.glass-lives {
    font-size: 18px;
    filter: drop-shadow(0 0 5px #ff0055);
}
.glass-lives.beating { animation: heartbeat 1.5s infinite; }

.glass-round {
    font-family: 'Orbitron', sans-serif;
    color: #fbbf24;
    font-size: 14px;
    letter-spacing: 2px;
}

.game-close { font-size: 20px; color: #666; cursor: pointer; }

.glass-body {
    padding: 30px 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    flex-grow: 1;
}

.glass-question {
    font-family: 'Rajdhani', sans-serif;
    font-size: 22px;
    font-weight: 700;
    text-align: center;
    color: #fff;
    margin-bottom: 30px;
    line-height: 1.4;
}

.glass-opt-btn {
    width: 100%;
    max-width: 320px;
    padding: 16px;
    margin-bottom: 12px;
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    color: #fff;
    font-family: 'Rajdhani', sans-serif;
    font-size: 16px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
}

.glass-opt-btn:active {
    background: rgba(251, 191, 36, 0.1);
    border-color: #fbbf24;
    transform: scale(0.98);
}
.glass-opt-btn.selected {
    background: rgba(251, 191, 36, 0.2);
    border-color: #fbbf24;
    color: #fbbf24;
}

.sync-status { margin-top: 15px; font-size: 15px; color: rgba(255,255,255,0.5); font-style: italic; }

/* --- GLASS BUBBLE (INVITE) --- */
.glass-bubble {
    width: 85%;
    max-width: 280px;
    padding: 24px;
    border-radius: 24px;
    background: rgba(255, 255, 255, 0.05);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    align-self: center;
    margin: 10px 0;
}

.glass-title {
    font-family: 'Orbitron', sans-serif;
    font-size: 24px;
    font-weight: 900;
    background: linear-gradient(90deg, #fde047, #fbbf24, #eab308);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 8px;
    letter-spacing: 2px;
}

.glass-subtitle {
    font-family: 'Rajdhani', sans-serif;
    font-size: 14px;
    color: rgba(255, 255, 255, 0.6);
    margin-bottom: 20px;
}

.glass-btn {
    width: 100%;
    padding: 14px;
    border-radius: 16px;
    border: none;
    background: linear-gradient(90deg, #fde047, #fbbf24, #eab308);
    color: #000;
    font-family: 'Orbitron', sans-serif;
    font-weight: 800;
    font-size: 14px;
    cursor: pointer;
    box-shadow: 0 4px 15px rgba(251, 191, 36, 0.3);
    transition: transform 0.2s;
    animation: pulse-gold 2s infinite;
}
.glass-btn:active { transform: scale(0.96); }

/* --- STOIC PREMIUM CARD MODAL --- */
#profile-modal {
    position: fixed; top: 0; left: 0; width: 100%; height: 100%;
    background: rgba(0, 0, 0, 0.85); backdrop-filter: blur(15px);
    z-index: 10000; display: none; 
    align-items: center; justify-content: center;
}
#profile-modal.active { display: flex; }

.stoic-container {
    width: 85%; max-width: 350px;
    background: rgba(20, 20, 25, 0.95);
    border: 1px solid rgba(255, 215, 0, 0.3);
    border-radius: 30px;
    padding: 25px;
    display: flex; flex-direction: column; align-items: center;
    box-shadow: 0 20px 50px rgba(0,0,0,0.8);
}

.stoic-info { text-align: center; margin-bottom: 15px; }
#stoic-name {
    font-family: 'Orbitron', sans-serif; font-size: 22px; font-weight: 800;
    color: var(--gold); letter-spacing: 2px; margin-bottom: 4px;
    text-shadow: 0 0 10px rgba(255, 215, 0, 0.3);
}
#stoic-city {
    font-family: 'Rajdhani', sans-serif; font-size: 14px; font-weight: 600;
    color: rgba(255, 255, 255, 0.5); text-transform: uppercase; letter-spacing: 2px;
}

.stoic-photo-frame {
    width: 100%; aspect-ratio: 1/1;
    border-radius: 20px;
    border: 2px solid var(--gold);
    overflow: hidden;
    margin-bottom: 20px;
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.1);
    background: #000;
}
#profile-large-img { width: 100%; height: 100%; object-fit: cover; }

.stoic-action-bar {
    width: 100%; display: flex; flex-direction: column; gap: 10px;
}

.stoic-btn {
    width: 100%; padding: 14px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 16px;
    color: #fff;
    font-family: 'Orbitron', sans-serif;
    font-weight: 700;
    font-size: 14px;
    text-transform: uppercase;
    letter-spacing: 1px;
    cursor: pointer;
    transition: all 0.2s;
    text-align: center;
}
.stoic-btn:active { background: rgba(255, 255, 255, 0.1); transform: scale(0.98); }

.btn-write { border-color: var(--neon-blue); color: var(--neon-blue); box-shadow: 0 0 10px rgba(0, 243, 255, 0.1); }
.btn-chance { border-color: var(--gold); color: var(--gold); box-shadow: 0 0 10px rgba(255, 215, 0, 0.1); }

.modal-close-btn {
    margin-top: 15px;
    font-size: 12px; color: #666; cursor: pointer;
    font-family: 'Orbitron', sans-serif; letter-spacing: 1px;
}

/* ========================================= */
/* COMPACT GIFT BAR (UPDATED) */
/* ========================================= */

.gift-sticky-bar {
    position: absolute;
    bottom: 110px; /* Positioned above controls */
    left: 50%;
    transform: translateX(-50%);
    width: auto;
    background: rgba(10, 10, 10, 0.95);
    border: 1px solid var(--gold);
    border-radius: 50px; /* Capsule shape */
    padding: 8px 20px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    box-shadow: 0 0 20px rgba(255, 215, 0, 0.2);
    z-index: 900;
    opacity: 0;
    pointer-events: none;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.gift-sticky-bar:not(.hidden) {
    opacity: 1;
    bottom: 120px; /* Float up effect */
    pointer-events: all;
}

.sticky-left-side { display: flex; align-items: center; gap: 10px; }

.sticky-icon {
    width: 24px; height: 24px;
    display: flex; align-items: center; justify-content: center;
}
.sticky-icon svg { width: 20px; height: 20px; }

.sticky-info { display: flex; flex-direction: column; justify-content: center; }

.sticky-title {
    font-family: 'Orbitron', sans-serif;
    color: var(--gold);
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 1px;
    text-transform: uppercase;
    line-height: 1;
}

.sticky-hint {
    font-family: 'Rajdhani', sans-serif;
    font-size: 10px;
    color: rgba(255, 255, 255, 0.6);
    text-transform: uppercase;
    margin-top: 2px;
}

.sticky-close-btn {
    width: 20px; height: 20px;
    display: flex; align-items: center; justify-content: center;
    color: rgba(255, 255, 255, 0.5);
    font-size: 14px;
    cursor: pointer;
    margin-left: 5px;
}

/* --- IMPACT ANIMATIONS (NEW) --- */

/* 1. TAP RIPPLE */
.anim-tap .avatar { animation: tapPulse 0.4s ease-out; }
.fx-ripple {
    position: absolute; inset: -5px; border: 2px solid var(--gold); border-radius: 50%;
    animation: rippleExpand 0.5s ease-out forwards; pointer-events: none; z-index: 1;
}
@keyframes rippleExpand { 0% { transform: scale(1); opacity: 0.8; } 100% { transform: scale(1.5); opacity: 0; } }
@keyframes tapPulse { 50% { transform: scale(0.95); } }

/* 2. HEART (PULSE) */
.anim-heart .avatar { animation: heartBeat 0.8s cubic-bezier(0.36, 0, 0.66, -0.56); }
@keyframes heartBeat { 
    0%, 100% { transform: scale(1); filter: brightness(1); }
    15% { transform: scale(1.15); filter: brightness(1.5) sepia(1) hue-rotate(-50deg) saturate(3); box-shadow: 0 0 30px var(--color-heart); } 
    30% { transform: scale(0.95); }
    45% { transform: scale(1.1); }
}
.fx-heart-particle {
    position: absolute; font-size: 24px; pointer-events: none; z-index: 10;
    animation: floatUp 1s ease-out forwards; left: 50%; top: 50%;
}
@keyframes floatUp { 0% { transform: translate(-50%, -50%) scale(0); opacity: 0; } 20% { opacity: 1; } 100% { transform: translate(var(--tx), -100px) scale(1.2); opacity: 0; } }

/* 3. SPY (FLUID RADAR) */
.anim-spy .avatar { animation: spyScan 1.4s ease-in-out; }
@keyframes spyScan { 0%, 100% { filter: brightness(1); } 50% { filter: brightness(1.5) hue-rotate(90deg) saturate(2); } }

.fx-radar-sweep {
    position: absolute; left: 50%; top: 50%; width: 150%; height: 150%;
    background: conic-gradient(from 0deg, transparent 0deg, transparent 270deg, var(--neon-green) 360deg);
    transform: translate(-50%, -50%); border-radius: 50%; opacity: 0.6;
    animation: radarRotate 1.2s linear forwards; pointer-events: none; z-index: 3; mix-blend-mode: screen;
}
@keyframes radarRotate { from { transform: translate(-50%, -50%) rotate(0deg); opacity: 0; } to { transform: translate(-50%, -50%) rotate(360deg); opacity: 0; } }

/* 4. X-RAY (GLITCH RGB) */
.anim-xray .avatar { animation: glitchTear 0.6s steps(8); opacity: 0.5; }
@keyframes glitchTear { 
    0%, 100% { transform: translate(0); } 
    20% { transform: translate(-5px, 2px); } 
    40% { transform: translate(5px, -2px); } 
    60% { transform: translate(-3px, 3px); } 
}

.fx-rgb {
    position: absolute; inset: 0; border-radius: 20px; background-size: cover; background-position: center;
    pointer-events: none; mix-blend-mode: screen; z-index: 3; opacity: 0.8;
}
.fx-rgb.red { animation: rgbShiftRed 0.6s steps(5) forwards; filter: hue-rotate(-50deg) saturate(5); }
.fx-rgb.blue { animation: rgbShiftBlue 0.6s steps(5) forwards; filter: hue-rotate(180deg) saturate(5); }

@keyframes rgbShiftRed { 0% { transform: translate(0); opacity: 0; } 20% { transform: translate(-10px, 0); opacity: 1; } 100% { transform: translate(0); opacity: 0; } }
@keyframes rgbShiftBlue { 0% { transform: translate(0); opacity: 0; } 20% { transform: translate(10px, 0); opacity: 1; } 100% { transform: translate(0); opacity: 0; } }

/* =========================================
   SPY FIX: COMPACT & REVERSED (FINAL)
   ========================================= */

/* 1. РОДИТЕЛЬ (Обязательно relative) */
.avatar-wrapper, 
#my-avatar-wrapper,
.profile-avatar-container {
    position: relative !important; 
    overflow: hidden; 
    z-index: 1;
}

/* 2. КОНТЕЙНЕР: РОВНО ПО РАЗМЕРУ АВАТАРКИ */
.fx-spy-container {
    position: absolute;
    /* inset: 0 растягивает контейнер ровно по краям родителя (аватарки) */
    inset: 0; 
    width: 100%; 
    height: 100%;
    
    /* Убираем лишние сдвиги, теперь всё четко по центру */
    transform: none; 
    
    display: block;
    pointer-events: none; 
    z-index: 10;
}

/* 3. ВРАЩАЮЩИЙСЯ ЛУЧ (РАДАР) */
.fx-radar-sweep {
    position: absolute;
    inset: 0;
    
    /* Градиент радара */
    background: conic-gradient(from 0deg, transparent 0deg, transparent 270deg, var(--neon-green) 360deg);
    border-radius: 50%;
    opacity: 0.8; 
    mix-blend-mode: screen;
    
    /* scaleX(-1) - ЗЕРКАЛИТ направление градиента */
    /* rotate(360deg) - вращает по часовой. Если нужно против - поставь -360deg */
    animation: radarSpin 2s linear infinite;
    transform: scaleX(-1); /* <--- ЭТА ШТУКА ДЕЛАЕТ ЗЕРКАЛЬНО */
}

/* 4. КОЛЬЦА (SONAR) - Тоже компактные */
.fx-sonar-ring {
    position: absolute;
    inset: 0;
    border: 2px solid var(--neon-green); 
    border-radius: 50%; 
    opacity: 0; 
    box-shadow: 0 0 10px var(--neon-green); /* Чуть меньше свечение */
}

.sonar-1 { animation: sonarExpand 2s ease-out infinite; }
.sonar-2 { animation: sonarExpand 2s ease-out 0.6s infinite; }

/* АНИМАЦИИ */
@keyframes radarSpin { 
    from { transform: scaleX(-1) rotate(0deg); } 
    to { transform: scaleX(-1) rotate(360deg); } 
}

@keyframes sonarExpand { 
    0% { transform: scale(0.5); opacity: 0; border-width: 3px; } 
    20% { opacity: 1; }
    100% { transform: scale(1.0); opacity: 0; border-width: 0px; } 
}

/* --- PROFILE EDIT STYLES --- */

.profile-avatar-container {
    position: relative;
    width: 140px;
    height: 140px;
    cursor: pointer;
    /* Убедимся, что контейнер не схлопывается */
    display: flex;
    justify-content: center;
    align-items: center;
}

/* Уточнение для существующего класса, чтобы он заполнял контейнер */
.profile-avatar-container .avatar-large {
    width: 100%;
    height: 100%;
    /* Сохраняем существующие тени и границы из .avatar-large */
}

.edit-badge {
    position: absolute;
    bottom: 5px;
    right: 5px;
    width: 36px;
    height: 36px;
    background: var(--gold); /* Золотой фон */
    border-radius: 50%;
    border: 2px solid #000; /* Контрастная обводка */
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 0 15px rgba(255, 215, 0, 0.6);
    z-index: 20;
    transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}

.edit-badge:active {
    transform: scale(0.9);
}

.edit-badge svg {
    width: 20px;
    height: 20px;
    fill: #000; /* Черная иконка на золотом */
}